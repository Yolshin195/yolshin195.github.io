<!DOCTYPE html>
<html lang="{{ lang }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ resume.personal_info.full_name }} | {{ resume.personal_info.title }}</title>
    <style>
        :root {
            /* Rust Branding Palette */
            --primary: #f46623;
            --primary-hover: #da4a04;
            --accent: #2e3440;
            --bg-body: #121212;
            --bg-card: #1e1e1e;
            --text-main: #e5e7eb;
            --text-muted: #9ca3af;
            --border: #333333;
            --glass: rgba(30, 30, 30, 0.8);
        }

        [data-theme="light"] {
            --bg-body: #f9f9f9;
            --bg-card: #ffffff;
            --text-main: #1a1a1a;
            --text-muted: #666666;
            --border: #e5e7eb;
            --glass: rgba(255, 255, 255, 0.8);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            line-height: 1.6;
            -webkit-print-color-adjust: exact;
        }

        .controls {
            position: fixed; top: 1.5rem; right: 1.5rem; display: flex; gap: 0.5rem; z-index: 100;
            backdrop-filter: blur(8px); background: var(--glass); padding: 0.5rem; border-radius: 1rem;
            border: 1px solid var(--border);
        }

        .control-btn {
            background: transparent; border: none; color: var(--text-main); padding: 0.5rem 1rem;
            border-radius: 0.5rem; cursor: pointer; font-weight: 500;
        }
        .control-btn:hover { background: var(--primary); color: white; }

        .container { max-width: 1100px; margin: 2rem auto; padding: 0 1rem; }

        .resume-grid {
            display: grid; grid-template-columns: 320px 1fr; gap: 0;
            background: var(--bg-card); border-radius: 1.5rem; overflow: hidden;
            border: 1px solid var(--border);
        }

        .sidebar { background: rgba(0,0,0,0.15); padding: 3rem 2rem; border-right: 1px solid var(--border); }
        .main-content { padding: 3rem; }

        .name { font-size: 2rem; font-weight: 800; color: var(--primary); margin-bottom: 0.5rem; }
        .job-title { font-size: 1.1rem; color: var(--text-muted); font-weight: 500; }

        .contact-item { display: flex; align-items: center; gap: 10px; margin-bottom: 0.8rem; font-size: 0.9rem; color: var(--text-muted); }
        .contact-item a { color: var(--text-main); text-decoration: none; }

        .section { margin-bottom: 3rem; }
        .section-header { display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem; }
        .section-header h2 { font-size: 1.1rem; text-transform: uppercase; letter-spacing: 0.1em; color: var(--primary); }
        .section-header::after { content: ''; flex: 1; height: 1px; background: var(--border); }

        /* –£–ë–†–ê–õ–ò –ö–†–£–ñ–ö–ò: –û—Å—Ç–∞–≤–∏–ª–∏ —Ç–æ–ª—å–∫–æ —á–∏—Å—Ç—É—é –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—É—é –ª–∏–Ω–∏—é */
        .timeline-item { position: relative; padding-left: 1.5rem; border-left: 2px solid var(--border); margin-bottom: 2rem; }
        .timeline-item::before { display: none; } /* –ü–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–µ–Ω–æ */

        .tags { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-top: 0.75rem; }
        .tag { background: var(--bg-body); padding: 0.25rem 0.75rem; border-radius: 0.4rem; font-size: 0.75rem; border: 1px solid var(--border); font-weight: 600; color: var(--text-muted); }

        ul.list-details { list-style: none; margin-top: 0.5rem; }
        ul.list-details li { position: relative; padding-left: 1.2rem; color: var(--text-muted); margin-bottom: 0.4rem; font-size: 0.95rem; }
        ul.list-details li::before { content: "¬ª"; position: absolute; left: 0; color: var(--primary); }

        /* –ü–ï–ß–ê–¢–¨ –ò –ú–û–ë–ò–õ–¨–ù–ê–Ø –ì–ï–ù–ï–†–ê–¶–ò–Ø PDF */
        @media print {
            @page { size: A4; margin: 10mm; }
            .controls { display: none !important; }
            .container { margin: 0; max-width: 100%; padding: 0; }
            .resume-grid { 
                display: block !important; 
                border: none !important; 
                background: white !important;
            }
            .sidebar { 
                border-right: none; 
                border-bottom: 2px solid #eee; 
                padding: 1rem 0 2rem 0; 
                background: transparent !important; 
            }
            .main-content { padding: 2rem 0 !important; }
            .section, .timeline-item { page-break-inside: avoid !important; break-inside: avoid !important; }
            .timeline-item { border-left: 2px solid #eee; } /* –¢–æ–Ω–∫–∞—è –ª–∏–Ω–∏—è –¥–ª—è –ø–µ—á–∞—Ç–∏ */
            .tag { border: 1px solid #ddd !important; background: transparent !important; color: #333 !important; }
            .name, .section-header h2 { color: #000 !important; }
            * { box-shadow: none !important; text-shadow: none !important; }
        }

        @media (max-width: 900px) { 
            .resume-grid { grid-template-columns: 1fr; border-radius: 1rem; }
            .sidebar { border-right: none; border-bottom: 1px solid var(--border); }
        }
    </style>
</head>
<body>

    <div class="controls">
        <select id="langSelector" class="control-btn" onchange="window.location.href=this.value === 'en' ? '/' : '/' + this.value">
            <option value="en" {% if lang == "en" %}selected{% endif %}>EN</option>
            <option value="ru" {% if lang == "ru" %}selected{% endif %}>RU</option>
            <option value="th" {% if lang == "th" %}selected{% endif %}>TH</option>
        </select>
        <button class="control-btn" data-theme="light">‚òÄÔ∏è</button>
        <button class="control-btn" data-theme="dark">üåô</button>
    </div>

    <div class="container">
        <div class="resume-grid">
            <aside class="sidebar">
                <div class="profile-header">
                    <h1 class="name">{{ resume.personal_info.full_name }}</h1>
                    <p class="job-title">{{ resume.personal_info.title }}</p>
                </div>

                <div class="contact-list" style="margin-top: 2rem;">
                    <div class="contact-item">üìç {{ resume.personal_info.location }}</div>
                    <div class="contact-item">‚úâÔ∏è <a href="mailto:{{ resume.personal_info.email }}">{{ resume.personal_info.email }}</a></div>
                    {% if let Some(tg) = &resume.personal_info.telegram %}<div class="contact-item">üì± {{ tg }}</div>{% endif %}
                </div>

                <div class="section" style="margin-top: 3rem;">
                    <div class="section-header"><h2>{{ t.technical_skills }}</h2></div>
                    {% for cat in &resume.technical_skills.category_skills %}
                    <div style="margin-bottom: 1.5rem;">
                        <p style="font-weight: 700; font-size: 0.8rem; margin-bottom: 0.4rem; opacity: 0.8; text-transform: uppercase; color: var(--primary); letter-spacing: 0.05em;">{{ cat.name }}</p>
                        <div class="tags">
                            {% for skill in &cat.skills %}<span class="tag">{{ skill }}</span>{% endfor %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </aside>

            <main class="main-content">
                <section class="section">
                    <div class="section-header"><h2>{{ t.summary }}</h2></div>
                    <p style="color: var(--text-muted); font-size: 1.05rem;">{{ resume.summary }}</p>
                </section>

                <section class="section">
                    <div class="section-header"><h2>{{ t.work_experience }}</h2></div>
                    {% for exp in &resume.work_experience %}
                    <div class="timeline-item">
                        <div style="font-weight: 700; font-size: 1.2rem;">{{ exp.position }}</div>
                        <div style="color: var(--primary); font-weight: 600;">{{ exp.company }}</div>
                        <div style="font-size: 0.85rem; color: var(--text-muted);">
                            {{ exp.start_date }} ‚Äî {% if let Some(end) = &exp.end_date %}{{ end }}{% else %}{{ t.present }}{% endif %}
                        </div>
                        <ul class="list-details">
                            {% for resp in &exp.responsibilities %}<li>{{ resp }}</li>{% endfor %}
                        </ul>
                    </div>
                    {% endfor %}
                </section>

                {% if resume.projects.len() > 0 %}
                <section class="section">
                    <div class="section-header"><h2>{{ t.projects }}</h2></div>
                    {% for proj in &resume.projects %}
                    <div class="timeline-item">
                        <div style="font-weight: 700; font-size: 1.2rem;">{{ proj.name }}</div>
                        <div class="tags">
                            {% for tech in &proj.stack %}<span class="tag" style="background: var(--primary); color: white; border: none;">{{ tech }}</span>{% endfor %}
                        </div>
                        <p style="margin-top: 0.6rem; font-style: italic; font-size: 0.9rem; color: var(--text-main);">{{ proj.description }}</p>
                        <ul class="list-details">
                            {% for h in &proj.highlights %}<li>{{ h }}</li>{% endfor %}
                        </ul>
                    </div>
                    {% endfor %}
                </section>
                {% endif %}

                <section class="section">
                    <div class="section-header"><h2>{{ t.education }}</h2></div>
                    {% for edu in &resume.education %}
                    <div class="timeline-item">
                        <div style="font-weight: 700;">{{ edu.degree }}</div>
                        <div style="color: var(--text-muted);">{{ edu.institution }}</div>
                        <div style="font-size: 0.85rem; color: var(--primary);">
                            {{ edu.start_year }} ‚Äî {% if let Some(end) = edu.end_year %}{{ end }}{% else %}{{ t.present }}{% endif %}
                        </div>
                    </div>
                    {% endfor %}
                </section>

                {% if let Some(add) = &resume.additional %}
                <section class="section" style="margin-bottom: 0;">
                    <div class="section-header"><h2>{{ t.additional }}</h2></div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; font-size: 0.95rem;">
                        {% if let Some(level) = &add.english_level %}
                        <div><strong style="color: var(--primary);">{{ t.english_level }}:</strong> {{ level }}</div>
                        {% endif %}
                        
                        {% if let Some(reloc) = add.relocation_ready %}
                        <div><strong style="color: var(--primary);">{{ t.relocation }}:</strong> {% if reloc %}{{ t.yes }}{% else %}{{ t.no }}{% endif %}</div>
                        {% endif %}
                    </div>

                    {% if let Some(interests) = &add.interests %}
                    <div style="margin-top: 1.5rem;">
                        <p style="font-weight: 700; margin-bottom: 0.5rem; color: var(--text-main); font-size: 0.9rem;">{{ t.interests }}:</p>
                        <div class="tags">
                            {% for interest in interests %}<span class="tag" style="font-weight: normal;">{{ interest }}</span>{% endfor %}
                        </div>
                    </div>
                    {% endif %}
                </section>
                {% endif %}
            </main>
        </div>
    </div>

    <script>
        const applyTheme = (theme) => {
            const isDark = theme === 'dark' || (theme === 'auto' && window.matchMedia('(prefers-color-scheme: dark)').matches);
            document.documentElement.setAttribute('data-theme', isDark ? 'dark' : 'light');
            localStorage.setItem('theme', theme);
        };
        document.querySelectorAll('[data-theme]').forEach(btn => btn.addEventListener('click', () => applyTheme(btn.dataset.theme)));
        applyTheme(localStorage.getItem('theme') || 'auto');
    </script>
</body>
</html>